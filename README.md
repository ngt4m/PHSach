# ğŸ“š Há»‡ thá»‘ng quáº£n lÃ½ kinh phÃ­ & phÃ¢n bá»• sÃ¡ch

## ğŸš€ Giá»›i thiá»‡u
Há»‡ thá»‘ng há»— trá»£ quáº£n lÃ½ quÃ¡ trÃ¬nh **nháº­p sÃ¡ch vÃ  phÃ¢n bá»• sÃ¡ch** cho cÃ¡c Ä‘Æ¡n vá»‹ dá»±a trÃªn **kinh phÃ­ Ä‘Æ°á»£c cáº¥p hÃ ng nÄƒm**.  
Má»¥c tiÃªu:
- Äáº£m báº£o phÃ¢n bá»• cÃ´ng báº±ng, minh báº¡ch, theo tá»· lá»‡ kinh phÃ­ cÃ²n láº¡i cá»§a tá»«ng Ä‘Æ¡n vá»‹.
- Giáº£m thiá»ƒu tÃ­nh toÃ¡n thá»§ cÃ´ng, há»— trá»£ bÃ¡o cÃ¡o nhanh vÃ  chÃ­nh xÃ¡c.
- Cho phÃ©p má»Ÿ rá»™ng theo nhiá»u nÄƒm, nhiá»u Ä‘á»£t, nhiá»u Ä‘Æ¡n vá»‹.

---

## ğŸ¢ Quy trÃ¬nh nghiá»‡p vá»¥

1. **Khá»Ÿi táº¡o Ä‘áº§u nÄƒm**
   - Nháº­p danh sÃ¡ch cÃ¡c Ä‘Æ¡n vá»‹.
   - GÃ¡n kinh phÃ­ ban Ä‘áº§u cho tá»«ng Ä‘Æ¡n vá»‹ trong nÄƒm lÃ m viá»‡c.

2. **Nháº­p sÃ¡ch theo Ä‘á»£t**
   - Má»—i nÄƒm cÃ³ nhiá»u Ä‘á»£t mua sÃ¡ch.
   - Má»™t Ä‘á»£t nháº­p thÆ°á»ng gá»“m ~20 Ä‘áº§u sÃ¡ch.
   - ThÃ´ng tin ghi nháº­n: mÃ£ sá»‘ sÃ¡ch, tÃªn, Ä‘Æ¡n vá»‹ tÃ­nh, giÃ¡, sá»‘ lÆ°á»£ng.

3. **PhÃ¢n bá»• sÃ¡ch**
   - Khi Ä‘á»£t nháº­p Ä‘á»§ sá»‘ lÆ°á»£ng sÃ¡ch, há»‡ thá»‘ng phÃ¢n bá»• vá» cÃ¡c Ä‘Æ¡n vá»‹.
   - NguyÃªn táº¯c:
     - Táº¥t cáº£ Ä‘Æ¡n vá»‹ Ä‘á»u nháº­n sÃ¡ch.
     - Sá»‘ lÆ°á»£ng phÃ¢n bá»• dá»±a theo **tá»· lá»‡ kinh phÃ­ cÃ²n láº¡i**.
     - Pháº§n dÆ° Ä‘Æ°á»£c lÃ m trÃ²n vÃ  Æ°u tiÃªn cho Ä‘Æ¡n vá»‹ cÃ³ tá»· lá»‡ cao hÆ¡n.

4. **Cáº­p nháº­t ngÃ¢n sÃ¡ch**
   - GiÃ¡ trá»‹ sÃ¡ch Ä‘Æ°á»£c trá»« vÃ o kinh phÃ­ cÃ²n láº¡i cá»§a Ä‘Æ¡n vá»‹.
   - NgÃ¢n sÃ¡ch cÃ²n láº¡i sáº½ Ä‘Æ°á»£c dÃ¹ng lÃ m cÆ¡ sá»Ÿ cho cÃ¡c Ä‘á»£t phÃ¢n bá»• sau.

5. **Theo dÃµi & BÃ¡o cÃ¡o**
   - BÃ¡o cÃ¡o theo Ä‘á»£t: chi tiáº¿t phÃ¢n bá»• tá»«ng Ä‘áº§u sÃ¡ch cho tá»«ng Ä‘Æ¡n vá»‹.
   - BÃ¡o cÃ¡o theo nÄƒm: tá»•ng há»£p sá»‘ sÃ¡ch vÃ  kinh phÃ­ Ä‘Ã£ cáº¥p cho tá»«ng Ä‘Æ¡n vá»‹.
   - Xuáº¥t bÃ¡o cÃ¡o dÆ°á»›i dáº¡ng Excel.

---

## ğŸ—„ï¸ Thiáº¿t káº¿ cÆ¡ sá»Ÿ dá»¯ liá»‡u

### Thá»±c thá»ƒ chÃ­nh
- **WorkYear**: nÄƒm lÃ m viá»‡c (2025, 2026, â€¦).
- **Unit**: Ä‘Æ¡n vá»‹ (trÆ°á»ng, phÃ²ng, thÆ° viá»‡n...).
- **UnitBudget**: kinh phÃ­ cá»§a Ä‘Æ¡n vá»‹ trong nÄƒm.
- **Batch**: Ä‘á»£t nháº­p sÃ¡ch.
- **BookBatch**: sÃ¡ch trong má»™t Ä‘á»£t.
- **Allocation**: káº¿t quáº£ phÃ¢n bá»• sÃ¡ch cho Ä‘Æ¡n vá»‹.
- **User**: tÃ i khoáº£n ngÆ°á»i dÃ¹ng há»‡ thá»‘ng.

### Quan há»‡
```
WorkYear ---< UnitBudget >--- Unit
     |
     +---< Batch ---< BookBatch >--- Allocation >--- UnitBudget
```

### MÃ´ táº£ báº£ng chÃ­nh

#### WorkYear
- WorkYearId (PK, varchar(50))
- Year (int)
- Description (nvarchar)
- CreatedAt (datetime)

#### Unit
- UnitId (PK, varchar(50))
- UnitCode (nvarchar, unique)
- UnitName (nvarchar)
- Address, ContactPerson, Phone
- CreatedAt (datetime)

#### UnitBudget
- UnitBudgetId (PK, varchar(50))
- UnitId (FK â†’ Unit)
- WorkYearId (FK â†’ WorkYear)
- InitialBudget, RemainingBudget (decimal)
- CreatedAt (datetime)
- RÃ ng buá»™c: **UnitId + WorkYearId UNIQUE**

#### Batch
- BatchId (PK, varchar(50))
- WorkYearId (FK â†’ WorkYear)
- BatchName (nvarchar)
- CreatedDate (datetime)

#### BookBatch
- BookBatchId (PK, varchar(50))
- BatchId (FK â†’ Batch)
- BookCode (nvarchar)
- Title (nvarchar)
- UnitOfMeasure (nvarchar, default 'cuá»‘n')
- Price (decimal)
- Quantity (int)

#### Allocation
- AllocationId (PK, varchar(50))
- BatchId (FK â†’ Batch)
- BookBatchId (FK â†’ BookBatch)
- UnitBudgetId (FK â†’ UnitBudget)
- AllocatedQuantity (int)
- AllocatedCost (decimal)
- CreatedAt (datetime)

#### User
- UserId (PK, varchar(50))
- Username (unique)
- PasswordHash
- FullName
- Role (admin, manager, viewer)
- CreatedAt
- IsActive

---

## ğŸ“Š VÃ­ dá»¥ quy trÃ¬nh dá»¯ liá»‡u

- **NÄƒm lÃ m viá»‡c**: 2025
- **ÄÆ¡n vá»‹**:
  - TrÆ°á»ng A: 100 triá»‡u
  - TrÆ°á»ng B: 50 triá»‡u
- **Äá»£t nháº­p (Batch1)**:
  - ToÃ¡n lá»›p 1: 100 cuá»‘n Ã— 10.000Ä‘
  - VÄƒn lá»›p 2: 80 cuá»‘n Ã— 20.000Ä‘
- **PhÃ¢n bá»• (Allocation)**:
  - ToÃ¡n lá»›p 1 â†’ A: 60 cuá»‘n (600.000Ä‘), B: 40 cuá»‘n (400.000Ä‘)
  - VÄƒn lá»›p 2 â†’ A: 48 cuá»‘n (960.000Ä‘), B: 32 cuá»‘n (640.000Ä‘)
- **Cáº­p nháº­t ngÃ¢n sÃ¡ch**:
  - TrÆ°á»ng A cÃ²n láº¡i: 100 triá»‡u â€“ 1,56 triá»‡u = 98,44 triá»‡u
  - TrÆ°á»ng B cÃ²n láº¡i: 50 triá»‡u â€“ 1,04 triá»‡u = 48,96 triá»‡u

---

## ğŸ”® HÆ°á»›ng má»Ÿ rá»™ng
- **Bá»• sung quáº£n lÃ½ kho**: theo dÃµi tá»“n kho sÃ¡ch sau khi phÃ¢n bá»•.
- **Bá»• sung audit log**: lÆ°u láº¡i lá»‹ch sá»­ thay Ä‘á»•i kinh phÃ­.
- **PhÃ¢n quyá»n ngÆ°á»i dÃ¹ng**: chi tiáº¿t hÆ¡n (nháº­p liá»‡u, phÃª duyá»‡t, bÃ¡o cÃ¡o).
- **API má»Ÿ rá»™ng**: tÃ­ch há»£p vá»›i há»‡ thá»‘ng quáº£n lÃ½ thÆ° viá»‡n hoáº·c giÃ¡o dá»¥c khÃ¡c.

---

## ğŸ‘¨â€ğŸ’» CÃ´ng nghá»‡ khuyáº¿n nghá»‹
- Backend: **ASP.NET Core + EF Core**
- Database: **SQL Server**
- Frontend: Razor Pages / MVC + Bootstrap
- Excel Import/Export: **EPPlus** hoáº·c **ClosedXML**
